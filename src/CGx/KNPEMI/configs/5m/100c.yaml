# KNP-EMI Config File
problem_type : "KNP-EMI"

# Input and output directories
input_dir  : '/home/hherlyng/knp-emi-cgx/src/CGx/KNPEMI/input/'
output_dir : '/global/D1/homes/hherlyng/knp-emi-cgx/output/GC/5m/100c/T_stim=1000ms_iterative_study_strong_threshold=0.85/'

# Numerical parameters 
dt : 0.000025 # Timestep size 
time_steps : 200 # Number of timesteps
# T  : 1000e-3 # Simulation end time

# Problem constants (in consistent units)
physical_constants:
  T : 300   # Temperature [K]
  F : 96485 # Faraday constant [C/mol]
  R : 8.314 # Gas constant [J/(K*mol)]

C_M : 0.01 # membrane capacitance [F/m^2]

# Mesh and meshtags files 
mesh_file      : "geometries/GC/5m/100c/mesh.xdmf"
cell_tag_file  : "geometries/GC/5m/100c/mesh.xdmf"
facet_tag_file : "geometries/GC/5m/100c/facets.xdmf"
mesh_conversion_factor: 1e-9

ics_tags  : !range [2, 102] # Intracellular space cell tags 
ecs_tags  : [1] # Extracellular space cell tags
boundary_tags : !range [1001, 1102] # Boundary facet tags
membrane_tags : !range [2, 102] # Membrane (interface) facet tags
# glia_tags : [71, 90, 95, 100]
stimulus_tags : [56] # Membrane facet tags of the cells being stimulated
membrane_data_tag : 56 # Tag for which membrane data is written to file

# stimulus_region : 
#   range : [1150, 1250]
#   direction : "x"

point_evaluation :
  ics_points   : [[1200, 3102, 3497], [1200, 3302, 3476]] # Neuron and glia
  ecs_points   : [[1200, 3113, 3607], [1200, 1334, 3934]]
  gamma_points : [[1185.88, 3240.52, 3593.71], [1197.76, 3316.25, 3654.94]] # Neuron and glia

stimulus :
  conductance :
    g_syn_bar : 60 # 500 #2e-10  # Maximum synaptic conductance [S/m^2]
  a_syn : 5e-4 # Synaptic time constant
  T_stim : 1000e-3 # Stimulus period, high freq = 20 ms, normal freq = 1 s
  scale : False

solver :
  direct : False
  ksp_settings:
    strong_threshold : 0.85
  output :
    save_xdmf : False
    save_cpoints : False
    save_pngs : True
    save_dat : True
    save_interval : 1000

# # Initial conditions for neuron + glia model
# initial_conditions :
#   phi_m_n : -0.071476574037297763
#   Na_i_n : 10.268351217499580130
#   Na_e : 144.740072668359516683
#   K_i_n : 129.811642546718417179
#   K_e : 3.049044160053175467
#   Cl_i_n : 5.081337524756735391
#   Cl_e : 133.785333554356469676
#   phi_m_g : -0.084996821307740056
#   Na_i_g : 13.543440659897848732
#   K_i_g : 101.414173028833531021
#   Cl_i_g : 4.957608889044861300
#   n: 0.224681342597906120
#   m: 0.024051779454228470
#   h: 0.792151725333791079

# # Initial conditions neuron-only model:
# initial_conditions :
#   phi_m_n : -0.071368090909519982
#   Na_i_n : 10.177828789157535638
#   Na_e : 144.438571225716970048
#   K_i_n : 129.961741885037213251
#   K_e : 3.120785878822987414
#   Cl_i_n : 5.140904219244766260
#   Cl_e : 133.555146928250763949
#   n: 0.226113371045924300
#   m: 0.024380520164517472
#   h: 0.789505789611991027